(this.webpackJsonpphase10=this.webpackJsonpphase10||[]).push([[0],{14:function(e,t,n){e.exports=n(31)},19:function(e,t,n){},20:function(e,t,n){},31:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),c=n(13),o=n.n(c),s=(n(19),n(3));n(20);var u=function(e){var t=e.closeModal,n=e.children;return r.a.createElement("div",{style:{position:"fixed",top:0,bottom:0,left:0,right:0,backgroundColor:"#282c34",zIndex:10,overflowY:"scroll",paddingBottom:"50px"}},r.a.createElement("div",{style:{height:"20px",top:0}},r.a.createElement("div",{style:{position:"absolute",right:0,padding:"10px",fontWeight:"bold"},onClick:t},"X")),n)};var l=function(e){var t=e.userList,n=e.isHost,a=e.removeUser,c=e.isScoreScreen,o=void 0!==c&&c,s=e.isEndScreen,u=void 0!==s&&s,l=t.map((function(e){return e}));return o&&l.sort((function(e,t){return e.gameScore-t.gameScore})),r.a.createElement("ol",{className:o?"score-list":"users-ingame"},l.map((function(e,t){return r.a.createElement("li",{className:"".concat(e.uid," ").concat(e.host&&"host"),key:"userList-".concat(t)},r.a.createElement("span",null,e.displayName),o?": ".concat(e.gameScore):"",!u&&o?" (+".concat(e.scoreAddedThisRound,")"):"",n&&!e.host&&!o&&r.a.createElement("button",{key:"remove-".concat(e.uid),className:"remove-user",onClick:function(){return a(e.uid)}},"Remove user"))})))};var i=function(e){var t=e.error,n=e.isLoading,a=e.isNewUser,c=e.displayName,o=e.onDisplayNameSubmit,s=e.startGame,u=e.userList,i=e.isHost,d=e.removeUser;return r.a.createElement(r.a.Fragment,null,r.a.createElement("header",{className:"App-header"},r.a.createElement("h1",null,"Phase 10")),t&&r.a.createElement("p",{dangerouslySetInnerHTML:{__html:t}}),n?r.a.createElement("p",null,"loading..."):a?a&&r.a.createElement(r.a.Fragment,null,r.a.createElement("h2",null,"Welcome!"),r.a.createElement("p",null,"Please enter a username to join the game"),r.a.createElement("label",{htmlFor:"display-name"},"Name:"),r.a.createElement("input",{id:"display-name",type:"text",placeholder:"Display Name"}),r.a.createElement("button",{onClick:o},"Submit")):r.a.createElement("p",null,c),i&&!a&&u.length>0&&r.a.createElement("button",{onClick:s},"Everybody's In"),r.a.createElement(l,{userList:u,isHost:i,removeUser:d}))};var d=function(e){var t=e.card,n=e.onClick,a=t[1]||t,c=a.color,o=a.value,s=a.corners;return r.a.createElement("div",{onClick:n?function(){return n(t)}:function(){},"data-card-id":t[0],className:"card ".concat(c)},r.a.createElement("div",{className:"card-value"},o),r.a.createElement("div",{className:"card-top-left-value"},s),r.a.createElement("div",{className:"card-bottom-right-value"},s))},f=n(10),m=n.n(f);m.a.initializeApp({apiKey:"AIzaSyD7owlkcXvzdS8vHY2s3mt_Me-93ma2NZI",authDomain:"phase10-pemo.firebaseapp.com",databaseURL:"https://phase10-pemo.firebaseio.com",projectId:"phase10-pemo",storageBucket:"phase10-pemo.appspot.com",messagingSenderId:"879568671948",appId:"1:879568671948:web:fcf63e12d457b22afade69",measurementId:"G-M6NSG0LYQ8"});var h=m.a,p=h.database();function v(e){var t=e.length;p.ref("game/currentRound").once("value",(function(n){var a=n.val();p.ref("game/currentRound").set(a+1);var r=function(){for(var e=[],t=["red","yellow","green","blue"],n=0;n<t.length;n++){var a=t[n];e.push({value:"Skip",color:"black",corners:"S"});for(var r=1;r<=12;r++)e.push({value:r,color:a,corners:r}),e.push({value:r,color:a,corners:r}),1!==r&&2!==r||e.push({value:"Wild",color:"black",corners:"W"})}return g(e)}(),c=10*t,o=r.splice(c,1);for(p.ref("game/discardPile").set(o),"Skip"===o[0].value&&a++,e.forEach((function(e){E(r,e.uid,10)})),p.ref("game/drawPile").set(r);a>t;)a-=t;var s=e.find((function(e){return e.turnOrder===a})).uid;p.ref("game/userList/".concat(s,"/isCurrentTurn")).set(!0)}))}function b(){p.ref("game/userList").once("value",(function(e){var t=!1;e.forEach((function(e){var n=e.val(),a=n.gameScore,r=n.hasLaidPhaseThisRound,c=n.currentHand,o=n.currentPhase,s=0;c&&Object.entries(c).forEach((function(e){"number"===typeof e[1].value?e[1].value<10?s+=5:s+=10:"Skip"===e[1].value?s+=15:s+=25})),e.child("scoreAddedThisRound").ref.set(s),e.child("gameScore").ref.set(a+s),r&&(10===o&&(t=!0),e.child("currentPhase").ref.set(o+1)),e.child("hasLaidPhaseThisRound").ref.set(!1),e.child("currentHand").ref.remove(),e.child("isCurrentTurn").ref.set(!1),e.child("hasDrawnThisTurn").ref.set(!1)})),p.ref("game/laidPhases").remove(),t?p.ref("game/state").set("game-end"):(v(Object.entries(e.val()).map((function(e){return e[1]}))),p.ref("game/state").set("round-end"))}))}function g(e){for(var t=e.length-1;t>0;t--){var n=Math.floor(Math.random()*(t+1)),a=[e[n],e[t]];e[t]=a[0],e[n]=a[1]}return e}function E(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,a=e.splice(0,n);a.forEach((function(e){p.ref("game/userList/".concat(t,"/currentHand")).push(e)}))}var y={initializePhase10:function(e){return p.ref("game/userList").once("value").then((function(t){var n=0;t.forEach((function(t){n++,t.child("gameScore").ref.set(0),t.child("currentPhase").ref.set(1),t.child("hasLaidPhaseThisRound").ref.set(!1),t.child("currentHand").ref.remove(),t.child("turnOrder").ref.set(n),t.child("isCurrentTurn").ref.set(!1),t.child("hasDrawnThisTurn").ref.set(!1),t.child("scoreAddedThisRound").ref.set(0),e.find((function(e){return e.uid===t.val().uid})).turnOrder=n})),p.ref("game/currentRound").set(1),v(e)}))},drawFromPile:function(e,t){p.ref("game/".concat(e)).once("value",(function(n){var a=n.val();E(a,t),0===a.length&&"drawPile"===e&&p.ref("game/discardPile").once("value",(function(e){a=g(e.val()),p.ref("game/discardPile").set([])})),p.ref("game/".concat(e)).set(a),p.ref("game/userList/".concat(t,"/hasDrawnThisTurn")).set(!0)}))},discardFromHand:function(e,t,n,a){var r="game/userList/".concat(e,"/currentHand/").concat(n);p.ref(r).once("value",(function(e){var n=e.val();p.ref("game/discardPile").once("value",(function(e){var c=e.val()||[];if(c.unshift(n),p.ref("game/discardPile").set(c),p.ref(r).remove(),t<=1)b();else{var o=a.find((function(e){return e.isCurrentTurn})),s=a.find((function(e){return e.turnOrder===o.turnOrder+1}))||a.find((function(e){return 1===e.turnOrder}));if("Skip"===n.value){var u=a.find((function(e){return e.turnOrder===s.turnOrder+1}));s=u||a.find((function(e){return 1===e.turnOrder}))}!function(e,t){p.ref("game/userList/".concat(e,"/isCurrentTurn")).set(!1),p.ref("game/userList/".concat(t,"/hasDrawnThisTurn")).set(!1),p.ref("game/userList/".concat(t,"/isCurrentTurn")).set(!0)}(o.uid,s.uid)}}))}))},layDownPhase:function(e,t,n){var a=n.reduce((function(e,t){return e+t.cards.length}),0);p.ref("game/userList/".concat(e,"/hasLaidPhaseThisRound")).set(!0),n.forEach((function(t){t.cards.forEach((function(t){p.ref("game/userList/".concat(e,"/currentHand/").concat(t[0])).remove()}))})),p.ref("game/laidPhases/".concat(e)).set(n),a===t&&b()},hitOnLaidPhase:function(e,t,n,a,r,c,o){a.forEach((function(t){p.ref("game/userList/".concat(e,"/currentHand/").concat(t[0])).remove()})),t===a.length&&b();var s="game/laidPhases/".concat(r,"/").concat(c);p.ref(s).once("value",(function(e){var t=e.val(),r=t.cards,c=t.possiblePlays.options;n?(o||a[0][1].value)===c[0]?(r.unshift(a[0]),p.ref("".concat(s,"/cards")).set(r),p.ref("".concat(s,"/possiblePlays/options")).set([c[0]-1,c[1]])):(r.push(a[0]),p.ref("".concat(s,"/cards")).set(r),p.ref("".concat(s,"/possiblePlays/options")).set([c[0],c[1]+1])):a.forEach((function(e){r.push(e),p.ref("".concat(s,"/cards")).set(r)}))}))}},O=h.database();var P=function(e){var t=e.setIsDiscardDrawDisabled,n=e.onClick,c=Object(a.useState)({color:null,value:null}),o=Object(s.a)(c,2),u=o[0],l=o[1];return Object(a.useEffect)((function(){return O.ref("game/discardPile").on("value",(function(e){var n=e.val(),a=n?n[0]:{color:"black",value:"X",corners:""};l(a),"Skip"!==a.value&&n?t(!1):t(!0)})),function(){O.ref("game/discardPile").off()}}),[]),r.a.createElement(d,{onClick:n,card:u})};var S=function(e){var t=e.currentHand,n=e.onClick;return r.a.createElement("div",{className:"hand-wrapper"},t.map((function(e,t){return r.a.createElement(d,{card:e,key:"card-".concat(t,"-").concat(e[1].value),onClick:n})})))};var j=function(e){var t=e.onClick,n=h.database(),c=Object(a.useState)(0),o=Object(s.a)(c,2),u=o[0],l=o[1];Object(a.useEffect)((function(){return n.ref("game/drawPile").on("value",(function(e){var t=e.val()||[];l(t.length)})),function(){n.ref("game/drawPile").off()}}),[]);var i={color:"black draw-pile",value:"Draw Pile (".concat(u,")")};return r.a.createElement(d,{card:i,onClick:t,className:"draw-pile"})},k={1:{rules:[{type:"set",number:3,text:"first set of 3"},{type:"set",number:3,text:"second set of 3"}],text:["2 sets of 3"]},2:{rules:[{type:"set",number:3,text:"set of 3"},{type:"run",number:4,text:"run of 4"}],text:["1 set of 3","1 run of 4"]},3:{rules:[{type:"set",number:4,text:"set of 4"},{type:"run",number:4,text:"run of 4"}],text:["1 set of 4","1 run of 4"]},4:{rules:[{type:"run",number:7,text:"run of 7"}],text:["1 run of 7"]},5:{rules:[{type:"run",number:8,text:"run of 8"}],text:["1 run of 8"]},6:{rules:[{type:"run",number:9,text:"run of 9"}],text:["1 run of 9"]},7:{rules:[{type:"set",number:4,text:"first set of 4"},{type:"set",number:4,text:"second set of 4"}],text:["2 sets of 4"]},8:{rules:[{type:"color",number:7,text:"7 cards of one color"}],text:["7 cards of one color"]},9:{rules:[{type:"set",number:5,text:"set of 5"},{type:"set",number:2,text:"set of 2"}],text:["1 set of 5","1 set of 2"]},10:{rules:[{type:"set",number:5,text:"set of 5"},{type:"set",number:3,text:"set of 3"}],text:["1 set of 5","1 set of 3"]}},x=y.drawFromPile,L=y.discardFromHand,w=y.layDownPhase,C=h.database();var H=function(e){var t=e.currentHand,n=e.userId,c=e.userList,o=Object(a.useState)(!1),l=Object(s.a)(o,2),i=l[0],d=l[1],f=Object(a.useState)(1),m=Object(s.a)(f,2),h=m[0],p=m[1],v=Object(a.useState)(!1),b=Object(s.a)(v,2),g=b[0],E=b[1],y=Object(a.useState)(!1),O=Object(s.a)(y,2),H=O[0],T=O[1],R=Object(a.useState)(!1),D=Object(s.a)(R,2),W=D[0],M=D[1],A=Object(a.useState)([]),U=Object(s.a)(A,2),G=U[0],Y=U[1],z=Object(a.useState)(0),B=Object(s.a)(z,2),_=B[0],X=B[1],J=Object(a.useState)(!1),K=Object(s.a)(J,2),Q=K[0],V=K[1],Z=Object(a.useState)(""),$=Object(s.a)(Z,2),q=$[0],ee=$[1],te=Object(a.useState)([]),ne=Object(s.a)(te,2),ae=ne[0],re=ne[1],ce=Object(a.useState)([]),oe=Object(s.a)(ce,2),se=oe[0],ue=oe[1];function le(e){L(n,t.length,e[0],c),ve()}function ie(e){!g&&i&&x(e,n)}function de(e){var t=G.findIndex((function(t){return t[0]===e[0]})),n=G.map((function(e){return e}));-1===t?n.push(e):n.splice(t,1),Y(n)}function fe(){var e=k[h].rules,a="",r=e[_].number;if(G.length<r)return a="Not enough cards selected",void console.log(a);if(-1!==G.findIndex((function(e){return"Skip"===e[1].value})))return a="Skips cannot be played in phases",void console.log(a);var c=e[_].type,o=G.findIndex((function(e){return"Wild"!==e[1].value}));if(-1!==o){var s=e[_],u={cards:G,rule:s,possiblePlays:{valueType:"",options:[]}};if("run"===c){for(var l=G[o][1].value,i=l,d=o;d<G.length;d++){var f=G[d][1].value;if(i!==f&&"Wild"!==f)return a="These cards to do not make a run or may be out of order",void console.log(a);i++}var m=l-o;if(m<=0||i-1>=13)return void(a="These cards to do not make a run or may be out of order");u.possiblePlays.valueType="value",u.possiblePlays.options.push(m-1),u.possiblePlays.options.push(i)}if("set"===c){for(var p=G[o][1].value,v=o;v<G.length;v++){var b=G[v][1].value;if(p!==b&&"Wild"!==b)return void(a="These cards to do not make a run or may be out of order")}u.possiblePlays.valueType="value",u.possiblePlays.options.push(p)}if("color"===c){for(var g=G[o][1].color,E=o;E<G.length;E++){var y=G[E][1],O=y.color,P=y.value;if(g!==O&&"Wild"!==P)return void(a="These cards to do not make a run or may be out of order")}u.possiblePlays.valueType="color",u.possiblePlays.options.push(g)}if(se.push(u),e[_+1]){X(_+1);var S=ae.filter((function(e){return-1===G.findIndex((function(t){return t[0]===e[0]}))}));re(S),Y([])}else w(n,t.length,se),ve()}}function me(){var e=k[h].rules;return r.a.createElement("div",null,r.a.createElement("h1",null,"Select ",e[_].text),"run"===e[_].type&&r.a.createElement("p",null,"Please choose cards in order"),r.a.createElement(S,{currentHand:ae,onClick:de}),r.a.createElement("p",null,"Selected:"),r.a.createElement("div",{style:{minHeight:"84px"}},r.a.createElement(S,{currentHand:G,onClick:de})),r.a.createElement("button",{onClick:fe},_===e.length-1?"Lay down phase":"Next"))}function he(){return r.a.createElement("div",null,r.a.createElement("h1",null,"Select card to discard"),r.a.createElement(S,{currentHand:t,onClick:le}))}function pe(e){X(0),Y([]),ue([]),ee(e),re(t),V(!0)}function ve(){V(!1)}return Object(a.useEffect)((function(){return re(t),C.ref("/game/userList/".concat(n,"/")).on("value",(function(e){var t=e.val();d(t.isCurrentTurn||!1),E(t.hasDrawnThisTurn||!1),T(t.hasLaidPhaseThisRound||!1),p(t.currentPhase)})),function(){C.ref("/game/userList/".concat(n,"/isCurrentTurn")).off()}}),[]),r.a.createElement("div",null,Q&&r.a.createElement(u,{closeModal:ve},"laying"===q?r.a.createElement(me,null):"discarding"===q?r.a.createElement(he,null):"hitting"===q&&r.a.createElement(F,{userId:n,currentHand:t,selected:G,toggleInSelection:de,closeModal:ve})),r.a.createElement(N,{userList:c,userId:n}),r.a.createElement("div",{className:"round-middle"},r.a.createElement("div",{className:"card-piles-wrapper ".concat(i&&!g&&"highlight")},r.a.createElement("div",{className:"card-piles"},r.a.createElement(j,{onClick:function(){return ie("drawPile")}}),r.a.createElement(P,{onClick:W?function(){}:function(){return ie("discardPile")},setIsDiscardDrawDisabled:M}))),r.a.createElement("div",{className:"players-phase"},r.a.createElement("p",null,"Your phase: ",h),H?r.a.createElement(I,{uid:n}):k[h]&&k[h].text.map((function(e){return r.a.createElement("p",{key:"".concat(n,"-").concat(e),className:"phase-text"},e)})))),r.a.createElement("p",{className:"your-hand"},"Your hand:"),r.a.createElement(S,{currentHand:t}),i&&g?r.a.createElement("div",null,H?r.a.createElement("button",{onClick:function(){return pe("hitting")}},"Hit on laid phase"):r.a.createElement("button",{onClick:function(){return pe("laying")}},"Lay down phase"),r.a.createElement("button",{onClick:function(){return pe("discarding")}},"Discard and end turn")):r.a.createElement(r.a.Fragment,null))};var N=function(e){var t=e.userList,n=e.userId,a=t.find((function(e){return e.uid===n})),c=t.filter((function(e){return e.uid!==n}));c.sort((function(e,t){return e.turnOrder-t.turnOrder}));var o=c.findIndex((function(e){return e.turnOrder>a.turnOrder})),s=c.splice(o).concat(c);return r.a.createElement("div",{className:"other-players-wrapper"},s.map((function(e){return r.a.createElement("div",{key:"other-player-".concat(e.uid),className:"turn-indicator ".concat(e.isCurrentTurn&&"highlight")},r.a.createElement("div",{className:"other-player"},r.a.createElement("p",null,r.a.createElement("strong",null,e.displayName)),r.a.createElement("p",null,"Hand: ",e.currentHand?Object.keys(e.currentHand).length:0),r.a.createElement("p",null,"Phase: ",e.currentPhase),e.hasLaidPhaseThisRound?r.a.createElement(I,{uid:e.uid}):k[e.currentPhase]&&k[e.currentPhase].text.map((function(e){return r.a.createElement("p",{key:"".concat(n,"-").concat(e),className:"phase-text"},e)}))))})))},T=h.database();var I=function(e){var t=e.uid,n=Object(a.useState)([]),c=Object(s.a)(n,2),o=c[0],u=c[1];return Object(a.useEffect)((function(){T.ref("/game/laidPhases/".concat(t)).on("value",(function(e){if(e.val()){var t=[];e.val().forEach((function(e){var n=e.possiblePlays,a=e.rule.type,r=n.options;if("run"===a){var c=r[0]+1,o=r[1]-1;t.push("Run: ".concat(c,"... ").concat(o))}else t.push("Set: ".concat(r[0],"'s"))})),u(t)}}))}),[]),o.map((function(e){return r.a.createElement("p",{key:"".concat(t,"-").concat(e),className:"laid-phase"},e)}))},R=h.database(),D=y.hitOnLaidPhase;var F=function(e){var t=e.userId,n=e.currentHand,c=e.selected,o=e.toggleInSelection,u=e.closeModal,l=Object(a.useState)("pickPhase"),i=Object(s.a)(l,2),d=i[0],f=i[1],m=Object(a.useState)([]),h=Object(s.a)(m,2),p=h[0],v=h[1],b=Object(a.useState)({}),g=Object(s.a)(b,2),E=g[0],y=g[1],O=Object(a.useState)([]),P=Object(s.a)(O,2),j=P[0],k=P[1];function x(e){var t=e?[e]:c;if(-1!==t.findIndex((function(e){return"Skip"===e.value})))return!1;var n=E.possiblePlays,a=n.options,r=n.valueType,o=!0;return t.forEach((function(e){var t=e[1][r];"Wild"===e[1].value||a.includes(t)||(o=!1)})),o}function L(e,a){var r=E.possiblePlays,c=E.isRun,o=E.phaseIndex,s=E.laidId,l=r.options,i=l.includes(0)||l.includes(13);"Wild"!==e[1].value||i||a?x(e)&&(D(t,n.length,c,[e],s,o,a),f("pickPhase"),u()):(k(e),f("pickWildValue"))}function w(){return r.a.createElement(r.a.Fragment,null,r.a.createElement("h1",null,"Choose what to hit\xa0on"),r.a.createElement("ul",null,p.map((function(e){return e[1].map((function(t,n){var a=t.rule,c=t.possiblePlays,o=t.cards,s=a.type,u=c.options,l="run"===s;return u.includes(0)&&u.includes(13)?null:r.a.createElement("li",{onClick:function(){return function(e,t,n,a,r){y({laidId:e,phaseIndex:t,isRun:n,phaseCards:a,possiblePlays:r}),f("pickCards")}(e[0],n,l,o,c)},key:"hit-".concat(e[0],"-").concat(n)},r.a.createElement("p",null,"".concat(l?"Run:":'Set of "'.concat(u[0],'"s'))),r.a.createElement(S,{currentHand:o}))}))}))))}function C(){return r.a.createElement(r.a.Fragment,null,r.a.createElement("h1",null,"You chose:"),r.a.createElement(S,{currentHand:E.phaseCards}),r.a.createElement("p",null,"You can only hit with \n            ".concat(E.isRun?"a":"",' \n            "').concat(0!==E.possiblePlays.options[0]?E.possiblePlays.options[0]:E.possiblePlays.options[1],'" \n            card').concat(E.isRun?0!==E.possiblePlays.options[0]&&13!==E.possiblePlays.options[1]?' or a "'.concat(E.possiblePlays.options[1],'" card'):"":"s")),E.isRun&&r.a.createElement("p",null,"For a run, you can only hit with one card at a time."),r.a.createElement(S,{currentHand:n,onClick:E.isRun?L:o}),!E.isRun&&c.length>0&&r.a.createElement(r.a.Fragment,null,r.a.createElement("p",null,"Selected:"),r.a.createElement(S,{currentHand:c,onClick:o}),r.a.createElement("button",{onClick:function(){return function(){var e=E.isRun,a=E.phaseIndex,r=E.laidId;x()&&(D(t,n.length,e,c,r,a),f("pickPhase"),u())}()}},"Hit with selected card",c.length>1&&"s")))}function H(){return r.a.createElement(r.a.Fragment,null,r.a.createElement("h1",null,"Select a value for your Wild:"),E.possiblePlays.options.map((function(e){return r.a.createElement("button",{onClick:function(){return L(j,e)},key:"select-wild-".concat(e)},e)})),r.a.createElement("p",null,"Hitting on the following run:"),r.a.createElement(S,{currentHand:E.phaseCards}))}return Object(a.useEffect)((function(){R.ref("game/laidPhases").once("value",(function(e){v(Object.entries(e.val()))}))}),[]),r.a.createElement("div",{className:"hit-view"},"pickPhase"===d?r.a.createElement(w,null):"pickCards"===d?r.a.createElement(C,null):r.a.createElement(H,null))},W=h.database();var M=function(e){var t=e.isHost,n=e.children,a=e.isEndOfGame;return r.a.createElement(r.a.Fragment,null,r.a.createElement("h1",null,a?"Game":"Round"," over!"),r.a.createElement("h2",null,a?"End":"Current"," scores:"),n,t&&r.a.createElement("button",{onClick:a?function(){W.ref("game/state").set("pregame")}:function(){W.ref("game/state").set("round")}},a?"End game":"Next round"))},A=h.database();var U=function(){var e=Object(a.useState)(""),t=Object(s.a)(e,2),n=(t[0],t[1]),c=Object(a.useState)(!1),o=Object(s.a)(c,2),u=o[0],d=o[1],f=Object(a.useState)(!0),m=Object(s.a)(f,2),p=m[0],v=m[1],b=Object(a.useState)(""),g=Object(s.a)(b,2),E=g[0],O=g[1],P=Object(a.useState)(!1),S=Object(s.a)(P,2),j=S[0],k=S[1],x=Object(a.useState)(0),L=Object(s.a)(x,2),w=L[0],C=L[1],N=Object(a.useState)([]),T=Object(s.a)(N,2),I=T[0],R=T[1],D=Object(a.useState)(""),F=Object(s.a)(D,2),W=F[0],U=F[1],G=Object(a.useState)([]),Y=Object(s.a)(G,2),z=Y[0],B=Y[1];function _(e){A.ref("/game/userList/".concat(e)).once("value",(function(t){var a=t.val();a?(n(a.displayName),v(!1),X(e,a.displayName),B(Object.entries(a.currentHand||{})||[])):(d(!0),v(!1))}))}function X(e,t){A.ref("/game/userList").once("value",(function(n){var a=[];if(n.forEach((function(t){var n=t.val();a.push(n),n.host&&e===n.uid&&k(!0)})),a.length>=6)U("There are already 6 people in this game.");else if(!(-1!==a.findIndex((function(t){return t.uid===e})))){var r=!a.length;k(r),A.ref("/game/userList/").child(e).set({displayName:t,uid:e,host:r,score:0,gameScore:0,currentPhase:1,hasLaidPhaseThisRound:!1})}}))}return Object(a.useEffect)((function(){var e=localStorage.getItem("p10-user-id"),t=e;return e?(C(e),_(e)):(h.auth().signInAnonymously().then((function(e){var t=e.user;localStorage.setItem("p10-user-id",t.uid)})).catch((function(e){var t=e.code,n=e.message;console.log(n,t)})),h.auth().onAuthStateChanged((function(e){if(e){var n=e.uid;C(n),t=n}})),_(w)),A.ref("/game/userList").on("value",(function(e){var t=[];e.forEach((function(e){t.push(e.val())})),R(t)})),A.ref("/game/userList").on("child_changed",(function(e){var t=e.val();I.find((function(e){return e.uid===t.uid}))})),A.ref("/game/state").on("value",(function(e){O(e.val())})),A.ref("/game/userList/".concat(t,"/currentHand")).on("value",(function(e){B(Object.entries(e.val()||{}))})),function(){A.ref("/game/userList/".concat(t,"/currentHand")).off(),A.ref("/game/state").off(),A.ref("/game/userList").off()}}),[]),r.a.createElement("div",{className:"App ".concat(w)},r.a.createElement("style",null,"\n        li.".concat(w," {\n          font-weight: bold;\n          color: seagreen;\n        }\n\n        .users-ingame li.").concat(w,'::after {\n          content: " (you)";\n        }\n\n        .users-ingame li.host::after {\n          content: " (host)";\n        }\n\n        .users-ingame li.').concat(w,'.host::after {\n          content: " (you, host)";\n        }\n        ')),r.a.createElement("main",null,p?r.a.createElement("p",null,"loading..."):"pregame"===E||u?r.a.createElement(i,{error:W,isNewUser:u,onDisplayNameSubmit:function(e){e.preventDefault();var t=document.getElementById("display-name").value;A.ref("/users/".concat(w,"/displayName")).set(t),n(t),X(w,t),d(!1)},isHost:j,userList:I,startGame:function(){y.initializePhase10(I).then((function(){A.ref("game/state").set("round")}))},removeUser:function(e){A.ref("game/userList/".concat(e)).remove(),A.ref("users/".concat(e)).remove()}}):"round"===E?r.a.createElement(H,{currentHand:z,userList:I,userId:w}):"round-end"===E||"game-end"===E?r.a.createElement(M,{isHost:j,isEndOfGame:"game-end"===E},r.a.createElement(l,{userList:I,isHost:j,removeUser:function(){},isScoreScreen:!0})):r.a.createElement("p",null,"Loading...")))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));o.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(U,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[14,1,2]]]);
//# sourceMappingURL=main.31fd5a60.chunk.js.map