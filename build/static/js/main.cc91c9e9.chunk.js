(this.webpackJsonpphase10=this.webpackJsonpphase10||[]).push([[0],{14:function(e,t,a){e.exports=a(31)},19:function(e,t,a){},20:function(e,t,a){},31:function(e,t,a){"use strict";a.r(t);var n=a(2),r=a.n(n),c=a(13),o=a.n(c),u=(a(19),a(5)),s=(a(20),a(10)),i=a.n(s);i.a.initializeApp({apiKey:"AIzaSyD7owlkcXvzdS8vHY2s3mt_Me-93ma2NZI",authDomain:"phase10-pemo.firebaseapp.com",databaseURL:"https://phase10-pemo.firebaseio.com",projectId:"phase10-pemo",storageBucket:"phase10-pemo.appspot.com",messagingSenderId:"879568671948",appId:"1:879568671948:web:fcf63e12d457b22afade69",measurementId:"G-M6NSG0LYQ8"});var l=i.a,m=l.database();var d={initializePhase10:function(e){return m.ref("game/userList").once("value").then((function(t){var a=0;t.forEach((function(t){a++,t.child("gameScore").ref.set(0),t.child("currentPhase").ref.set(1),t.child("hasLaidPhaseThisRound").ref.set(!1),t.child("currentHand").ref.remove(),t.child("turnOrder").ref.set(a),t.child("isCurrentTurn").ref.set(!1),t.child("scoreAddedThisRound").ref.set(0),e.find((function(e){return e.uid===t.val().uid})).turnOrder=a})),m.ref("game/currentRound").set(0),function(e){var t=e.length;m.ref("game/currentRound").once("value",(function(a){var n=a.val();m.ref("game/currentRound").set(n++);var r=function(){for(var e=[],t=["red","yellow","green","blue"],a=0;a<t.length;a++){var n=t[a];e.push({value:"S",color:"black"});for(var r=1;r<=12;r++)e.push({value:r,color:n}),e.push({value:r,color:n}),1!==r&&2!==r||e.push({value:"W",color:"black"})}return function(e){for(var t=e.length-1;t>0;t--){var a=Math.floor(Math.random()*(t+1)),n=[e[a],e[t]];e[t]=n[0],e[a]=n[1]}return e}(e)}(),c=10*t;for(m.ref("game/discardPile").set(r.splice(c,1)),e.forEach((function(e){!function(e,t){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,n=e.splice(0,a);n.forEach((function(e){m.ref("game/userList/".concat(t,"/currentHand")).push(e)}))}(r,e.uid,10)})),m.ref("game/drawpile").set(r);n>t;)n-=t;var o=e.find((function(e){return e.turnOrder===n})).uid;m.ref("game/userList/".concat(o,"/isCurrentTurn")).set(!0)}))}(e)}))}};var f=function(){var e=l.database(),t=Object(n.useState)(""),a=Object(u.a)(t,2),c=a[0],o=a[1],s=Object(n.useState)(!1),i=Object(u.a)(s,2),m=i[0],f=i[1],h=Object(n.useState)(!0),p=Object(u.a)(h,2),v=p[0],g=p[1],b=Object(n.useState)("pregame"),E=Object(u.a)(b,2),y=E[0],S=E[1],O=Object(n.useState)(!1),j=Object(u.a)(O,2),w=j[0],I=j[1],L=Object(n.useState)(!1),k=Object(u.a)(L,2),N=k[0],P=k[1],A=Object(n.useState)(0),R=Object(u.a)(A,2),T=R[0],C=R[1],H=Object(n.useState)([]),M=Object(u.a)(H,2),z=M[0],B=M[1],D=Object(n.useState)(""),W=Object(u.a)(D,2),_=W[0],x=W[1];function G(t){e.ref("/users/".concat(t,"/displayName")).on("value",(function(e){var a=e.val();a?(o(a),g(!1),F(t,a)):(f(!0),g(!1))}))}function F(t,a){e.ref("/game/userList").once("value",(function(n){var r=[];if(n.forEach((function(e){var a=e.val();r.push(a),a.host&&t===a.uid&&P(!0)})),r.length>=6)x("There are already 6 people in this game.<br>An update is coming soon to allow watching matches.");else if(!(-1!==r.findIndex((function(e){return e.uid===t})))){var c=!r.length;e.ref("/game/userList/").child(t).set({displayName:a,uid:t,host:c,score:0,gameScore:0,currentPhase:1,hasLaidPhaseThisRound:!1})}}))}return Object(n.useEffect)((function(){var t=localStorage.getItem("p10-user-id"),a=t;t?(C(t),G(t)):(l.auth().signInAnonymously().then((function(e){var t=e.user;localStorage.setItem("p10-user-id",t.uid)})).catch((function(e){var t=e.code,a=e.message;console.log(a,t)})),l.auth().onAuthStateChanged((function(e){if(e){var t=e.uid;C(t),a=t}})),G(T)),e.ref("/game/userList").on("value",(function(e){var t=[];e.forEach((function(e){t.push(e.val())})),B(t)})),e.ref("/game/userList").on("child_changed",(function(e){var t=e.val();z.find((function(e){return e.uid===t.uid}));t.uid===a&&I(t.isCurrentTurn)})),e.ref("/game/state").on("value",(function(e){S(e.val())}))}),[]),r.a.createElement("div",{className:"App ".concat(T)},r.a.createElement("style",null,"\n        li.".concat(T," {\n          font-weight: bold;\n          color: seagreen;\n        }\n\n        li.").concat(T,'::after {\n          content: " (you)"\n        }\n\n        li.host::after {\n          content: " (host)"\n        }\n\n        li.').concat(T,'.host::after {\n          content: " (you, host)"\n        }\n        ')),r.a.createElement("header",{className:"App-header"},r.a.createElement("h1",null,"Phase 10")),r.a.createElement("main",null,y,w&&r.a.createElement("h1",null,"It is your turn"),_&&r.a.createElement("p",{dangerouslySetInnerHTML:{__html:_}}),v?r.a.createElement("p",null,"loading..."):m?m&&r.a.createElement(r.a.Fragment,null,r.a.createElement("h2",null,"Welcome!"),r.a.createElement("p",null,"Please enter a username to join the game"),r.a.createElement("label",{for:"display-name"},"Name:"),r.a.createElement("input",{id:"display-name",type:"text",placeholder:"Display Name"}),r.a.createElement("button",{onClick:function(t){t.preventDefault();var a=document.getElementById("display-name").value;e.ref("/users/".concat(T,"/displayName")).set(a),o(a),F(T,a),f(!1)}},"Submit")):r.a.createElement("p",null,c),N&&!m&&z.length>0&&r.a.createElement("button",{onClick:function(t){d.initializePhase10(z).then((function(){e.ref("game/state").set("round")}))}},"Start Game"),r.a.createElement("ul",null,z.map((function(t,a){return r.a.createElement(r.a.Fragment,null,r.a.createElement("li",{className:"".concat(t.uid," ").concat(t.host&&"host"),key:"userList-".concat(a)},t.displayName,": ",t.gameScore,N&&!t.host&&r.a.createElement("button",{key:"remove-".concat(t.uid),className:"remove-user",onClick:function(){return a=t.uid,e.ref("game/userList/".concat(a)).remove(),void e.ref("users/".concat(a)).remove();var a}},"Remove user")),t.currentHand&&Object.entries(t.currentHand).map((function(e){var t=e[1],a=t.value,n=t.color;return r.a.createElement("span",{className:"card ".concat(n)},a," ")})))})))))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));o.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(f,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[14,1,2]]]);
//# sourceMappingURL=main.cc91c9e9.chunk.js.map